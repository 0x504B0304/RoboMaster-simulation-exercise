#!/usr/bin/env python
# coding: utf-8

# In[85]:


import numpy as np
import torch as t
import matplotlib.pyplot as plt
import math
get_ipython().run_line_magic('matplotlib', 'inline')


# 下面的theta列表一长串是测量的待拟合数据

# In[64]:


theta = [0.28175880273097964, 0.2927108453644472, 0.2699660385819568, 0.2863902846290065, 0.32203716546126504, 0.31202111332829363, 0.31689905300207216, 0.32756920679336193, 0.3241228291076524, 0.3146691563641499, 0.3483643275131785, 0.36060485986519153, 0.3507221048164484, 0.363051818958919, 0.37089041167768566, 0.36843736330519733, 0.3859101070056843, 0.37921121213845965, 0.37240173204370364, 0.38993920706632557, 0.40052024558665195, 0.41733690684480657, 0.4231050316488615, 0.39641238000842355, 0.41982406908771586, 0.43174750396553846, 0.44091611028340016, 0.4230754100435654, 0.4304153623312816, 0.4540436298462952, 0.4487195103988631, 0.44612434480869756, 0.4768834145938216, 0.4444550975235481, 0.4821268233896303, 0.462594929533591, 0.4867047723516049, 0.4776126248196187, 0.4932235318980874, 0.49367145182181105, 0.5148093168793609, 0.5020648955489776, 0.5169849076481631, 0.5258128488103923, 0.5171670941606055, 0.5451354494416594, 0.5332909331164828, 0.5460005371949219, 0.556668634687936, 0.5482131997052316, 0.5423289971608729, 0.5520648403903017, 0.5606743040860308, 0.5753377483518397, 0.5817445570363655, 0.59039434326141, 0.5838257714557485, 0.5992476613316096, 0.6054133565088049, 0.613776064789373, 0.623448223568841, 0.6144373107657238, 0.6307925101501425, 0.6372927417603745, 0.6289906880761139, 0.6355902946784859, 0.6586272323754758, 0.6421357571153197, 0.6614568265491045, 0.6707425408467222, 0.6618148433976788, 0.6672109254430368, 0.6772254837456475, 0.6928137963688169, 0.6942711518955166, 0.733407965021333, 0.7262475857305064, 0.72483535867511, 0.7184070443768981, 0.739365741901785, 0.7503048485600916, 0.7545097608702634, 0.7738755928001981, 0.7647047459366834, 0.8007435599368632, 0.7889483688204734, 0.7908643043412813, 0.7965509760457312, 0.8138895291793556, 0.8167222658347392, 0.833207002306176, 0.8575490790017631, 0.8510590861322482, 0.848747458725449, 0.8564626113280706, 0.8708018611823052, 0.8875108975677338, 0.8952390181639903, 0.9020130661718918, 0.9019902724388893, 0.9117282239619124, 0.9253903606655559, 0.9386946824380563, 0.9603498619645704, 0.96321307502796, 0.9746450075833941, 0.9747893920892842, 1.0053526318667956, 1.0068174301071433, 1.0171008499743508, 1.0235966394580764, 1.0418046476618992, 1.03414927725179, 1.064255484993258, 1.0776250808326413, 1.093756091609657, 1.1117947478077412, 1.1088665725779825, 1.1344894626656559, 1.1396705277807075, 1.1520071197833646, 1.1754821492840293, 1.1662856521351699, 1.212620787970284, 1.1885005313090424, 1.2292152392154068, 1.2051239289997568, 1.2534944284882503, 1.2740749079470608, 1.2729156945525264, 1.284339896137019, 1.3041891513927821, 1.3177633343505537, 1.328464924272759, 1.3368073401264715, 1.374229883837053, 1.3608248393080926, 1.4001948108542142, 1.401790239096043, 1.4264721931359228, 1.4370129717851639, 1.4538342783728007, 1.4744806674470938, 1.4781004972427816, 1.5224694538914447, 1.5314985128928669, 1.5317942778736335, 1.555848823700145, 1.5601025462734524, 1.58736559739159, 1.6258083229825264, 1.6202417328750587, 1.6516414722757087, 1.6487372708715426, 1.6616716903302629, 1.6875613273875252, 1.7157774527489729, 1.7215938684094425, 1.745347998484109, 1.754208871682773, 1.7858911274966365, 1.7814349496017146, 1.8208206014286266, 1.830618289214678, 1.8573617499078858, 1.8776652742103241, 1.879547866239606, 1.9207621746821295, 1.9261416522191113, 1.9516667623579766, 1.9733136752873057, 1.9928141694688282, 2.011960839586881, 2.015992103594785, 2.032020299049893, 2.053184594970574, 2.0937436899162547, 2.10238817988994, 2.130341941312167, 2.14806251163973, 2.1596396538734175, 2.204651052782464, 2.196336064052, 2.226923491658807, 2.260064402886662, 2.2479012667095635, 2.2754674595258013, 2.2912608794012876, 2.316116695564678, 2.343672124585278, 2.3784420618147357, 2.3892083767745, 2.4122062254148715, 2.4373662662955224, 2.4569372150987547, 2.4589835680485046, 2.4948634300726478, 2.5080902546633626, 2.5390199541308744, 2.563638882341907, 2.566828287242471, 2.589420842882943, 2.6125727838850157, 2.6543254129866125, 2.6608801551013754, 2.681130352963376, 2.695188530007586, 2.7175361667221583, 2.7380203021191165, 2.7622378478129943, 2.777790799444579, 2.7991718600235966, 2.831222548786436, 2.846789908894366, 2.8674725288920153, 2.8832176373705622, 2.9131423682353126, 2.919002218506964, 2.9310673550038673, 2.957414891009509, 2.9935099340019398, 3.019267022930561, 3.025793067031094, 3.046432836538901, 3.0684127137911794, 3.09556131012623, 3.109144525150511, 3.138970975240814, 3.1441496438039422, 3.1559225595110822, 3.215873141470729, 3.209963344291894, 3.234992566531816, 3.2536982457167705, 3.288547698214601, 3.2944162028158592, 3.3190111289507134, 3.3382409364866756, 3.371599516887878, 3.3690297981001933, 3.376323043598104, 3.3958095650842486, 3.449556844990727, 3.4380034922727796, 3.454796226473436, 3.4713387449401507, 3.5047962819538925, 3.5012276330342367, 3.55072618029128, 3.563736036890632, 3.5679599772451605, 3.5927451344984838, 3.621462440321876, 3.6368208131697455, 3.6458255509225084, 3.6632455582900403, 3.6949844499148403, 3.7090042712461617, 3.713710343220326, 3.733146825942216, 3.7596732001400497, 3.772298705240044, 3.7691325349543856, 3.8118261763667958, 3.812504000239062, 3.8361866942322544, 3.861078797393044, 3.8616065904082606, 3.8590856746025715, 3.9108661123898765, 3.9205302588476894, 3.9141185123604263, 3.9397959895182284, 3.9610125327328807, 3.976176639623687, 4.0032969433507075, 4.011669621926645, 4.028061078966431, 4.040085791861886, 4.033244462526651, 4.057003086449387, 4.094225971850503, 4.094717294813073, 4.114517947304432, 4.124655141511783, 4.128730701289817, 4.1352645117963975, 4.145357459477761, 4.191102193530666, 4.1998994996834975, 4.169392940444411, 4.212983772447586, 4.233479468270996, 4.2430776732528335, 4.23024877223353, 4.276266845425395, 4.2715336428064665, 4.296435006158316, 4.308581461677147, 4.304465963170994, 4.324073310509725, 4.330777813995398, 4.348130811689963, 4.362144403973356, 4.364466414792226, 4.366525084878523, 4.39107696990062, 4.391945612459999, 4.399435631337562, 4.414957690691435, 4.441084417493265, 4.430281956818525, 4.425017363304388, 4.433673832386137, 4.464012153065982, 4.482719742360002, 4.481855333384889, 4.488302017443826, 4.516072921400569, 4.506989530442355, 4.5218308167073795, 4.526235184982669, 4.509433898042451, 4.547803327012606, 4.548513128894027, 4.555810483237558, 4.573685080568304, 4.570395942302813, 4.5838955520982, 4.605628761711648, 4.597930465877248, 4.60638237932333, 4.621474954688104, 4.62345429582999, 4.633583361125628, 4.6272166315373555, 4.655650549505105, 4.6476510526851955, 4.628538900588615, 4.661743217368768, 4.674530926448724, 4.670250179799986, 4.672577658170996, 4.698437645539651, 4.703388667942886, 4.69814374104073, 4.715967957291378, 4.7102295633529465, 4.7052797566728835, 4.729279844442953, 4.73830879486695, 4.743024266329658, 4.741021253433056, 4.759775193413042, 4.750240950093128, 4.758278766016351, 4.768366720593632, 4.765085998678955, 4.778954283223608, 4.78142486273815, 4.786637629527603, 4.79569302205109, 4.803572021224426, 4.792693823913221, 4.805163453591046, 4.81302437109568, 4.846674630455644, 4.822163732643209, 4.811750622541972, 4.832698556911097, 4.832549144510516, 4.8544715182320095, 4.859015565057811, 4.844386497505438, 4.854982831607003, 4.869219263763972, 4.888072852144129, 4.875043643559417, 4.879180011421982, 4.911095502721846, 4.899590859559295, 4.9000525190505595, 4.897873819113156, 4.90681237417287, 4.917836715642697, 4.893838605769041, 4.911882798766135, 4.946388183294112, 4.938915274874067, 4.947036612581267, 4.948693896674001, 4.9494564224320365, 4.959829305336699, 4.957076229777828, 4.954157708482732, 4.980854779534069, 4.983684493791326, 4.981948649780083, 4.977388215975422, 5.000444363902311, 4.99056629072686, 5.005562368620422, 5.0094153438662845, 5.037291680512767, 5.026047177491961, 5.03141018598125, 5.041305495521949, 5.044795463714389, 5.072088066598603, 5.063578957398677, 5.0542890332459125, 5.074272344675473, 5.1003364011550385, 5.081373062058983, 5.104047592256307, 5.106223883575288, 5.108383636300422, 5.128811027957454, 5.1570398745068395, 5.122409308032264, 5.153241046590935, 5.168896204610275, 5.174786883245534, 5.160040724536295, 5.172779076432809, 5.18586669589204, 5.187080077996474, 5.2183029161037595, 5.217956023335742, 5.2075957727985065, 5.226197199495086, 5.24242374126539, 5.248605977314254, 5.277688426168698, 5.273907018543868, 5.284217018961597, 5.310254730410809, 5.306764801682837, 5.310472848758419, 5.317683654690722, 5.353053866470919, 5.347471179256058, 5.374484764993039, 5.381525383694542, 5.376236732787629, 5.3939895217145795, 5.401716013158392, 5.412202440536085, 5.416578726039352, 5.4495827867124556, 5.446953735534018, 5.457794174587915, 5.491132571084252, 5.502839400000016, 5.49243486727324, 5.5161142637805165, 5.543868653657016, 5.550429690288361, 5.560170327361577, 5.582357372073891, 5.5995757020289005, 5.594161429807469, 5.63038356191148, 5.6344185682258034, 5.644522915069835, 5.672659307453045, 5.655503984328886, 5.695130307667205, 5.692634572242571, 5.7241050034315055, 5.743746119777761, 5.746514452691666, 5.760152360481932, 5.766792364541727, 5.8003052603066045, 5.809404885461719, 5.828455917340019, 5.8091468654254514, 5.86115217560336, 5.877159406152468, 5.904129914239349, 5.916281850128277, 5.930932117574321, 5.928188705575517, 5.951399269486992, 5.9876455942074935, 5.98847367761189, 5.999544820146959, 6.022959283298611, 6.046980756865864, 6.079009115441559, 6.091257452225274, 6.105660855973461, 6.114881620391887, 6.130314319785262, 6.1549676015634045, 6.1661666051321955, 6.202547761776451, 6.210576554190815, 6.234812081922455, 6.248009668813913, 6.267219145832133, 6.297178176285492, 6.306770057395876, 6.330759195673607, 6.347432191637509, 6.368243296481021, 6.397737458857038, 6.40513814647861, 6.419674378117845, 6.4287495150867064, 6.471785485952439, 6.492318141515133, 6.504273092379527, 6.521400646016854, 6.545587980052791, 6.55357191661764, 6.579307232055907, 6.597329799305149, 6.636750338273036, 6.635037378062418, 6.680400552421395, 6.684667665417941, 6.724250602463575, 6.726890422065838, 6.75107470610755, 6.760098596664259, 6.7833891238306325, 6.80847252685797, 6.814925064222818, 6.862471068087439, 6.87848106812672, 6.901563366347935, 6.9192566178528505, 6.949464910417914, 6.957851831464318, 6.995348263647873, 7.006968562967751, 7.011879804928378, 7.036145807314178, 7.057582686168132, 7.090194574919961, 7.089792496832446, 7.126847527565274, 7.167942438961124, 7.157326671660433, 7.184825659249693, 7.209856642712531, 7.223606735464915, 7.255202060669811, 7.269789253505958, 7.300638414270991, 7.323799948882869, 7.323425285785729, 7.361389310994694, 7.381856305698033, 7.3780204847044395, 7.401689457725113, 7.412815472458568, 7.466631430560149, 7.480085250493267, 7.4841061219874625, 7.528842812200023, 7.535749381151207, 7.561810202871855, 7.5699225184060035, 7.596491806790921, 7.610169154636597, 7.615029856631747, 7.683021048363922, 7.676584696516514, 7.682828606215603, 7.720325727340873, 7.721234231573102, 7.747023551551609, 7.759047861310151, 7.818587599122668, 7.809622429326799, 7.8086804061967054, 7.857819766297346, 7.885473836043184, 7.89054951795824, 7.895686991485438, 7.907030035364271, 7.937184496731181, 7.949409672502395, 7.9564368327299775, 7.986921457985692, 7.999593214104392, 8.0243288964838, 8.059318745655878, 8.064684512470881, 8.074322292269644, 8.089062180942566, 8.118710400900824, 8.141249159230606, 8.155621158362742, 8.171931007525378, 8.182434752979294, 8.187825103025844, 8.211891308425033, 8.229159276890254, 8.250937414347437, 8.264876583461074, 8.2676823169098, 8.301322020727183, 8.30174673897887, 8.3069264732192, 8.32835942277369, 8.33252885894274, 8.365123872817632, 8.376715881791055, 8.394021518806731, 8.39532401167548, 8.425732614018772, 8.437353375145396, 8.458614980585883, 8.463260133485717, 8.477695549487656, 8.504870321991623, 8.508402682629649, 8.529133321632061, 8.557711911857533, 8.528728159954047, 8.56295122322397, 8.586182981007072, 8.593380568925623, 8.579469182154996, 8.60358773339368, 8.625835614945302, 8.628994351223849, 8.649264974876282, 8.662161387863584, 8.65818554090649, 8.681269036604379, 8.701429266783034, 8.716458030489818, 8.72366739078025, 8.741941544430308, 8.744290815862596, 8.741950878700372, 8.747379156054643, 8.75865846203444, 8.763251031547185, 8.776360442415344, 8.804760691300745, 8.814095846496393, 8.834321604076893, 8.820296584626991, 8.832844239905468, 8.847969328239742, 8.853844842782953, 8.865070186870835, 8.86860962820325, 8.875260067126913, 8.888846869374824, 8.89088998047826, 8.899885704857361, 8.915696515475716, 8.922940912127956, 8.923644220641886, 8.91793783831923, 8.921959349803613, 8.929652683962177, 8.951654247714162, 8.972462607558196, 8.960034866493045, 8.985311789998272, 8.963861496193118, 8.97825067780231, 8.99264304069619, 9.004970396632892, 9.029224504923926, 9.018755855391085, 9.041170135171857, 9.015870979081749, 9.036272096280861, 9.03909852388992, 9.059690969271223, 9.054313937582096, 9.059779063527767, 9.064556946397413, 9.057918193881738, 9.079316564969151, 9.104813951196853, 9.095752232823195, 9.090389049573831, 9.116622863968429, 9.077168814117256, 9.09499939453476, 9.118719165203935, 9.13231252428211, 9.121836999751666, 9.14059347725947, 9.139849280971761, 9.15431710002141, 9.150687411573413, 9.146148333951745, 9.172644205436496, 9.184676280959426, 9.182572414224374, 9.176491834918659, 9.189999063052717, 9.207782399008646, 9.187777104883278, 9.207499706721908, 9.207849298199552, 9.204188547162472, 9.210614651360137, 9.21615171846892, 9.217780137657506, 9.218184032248192, 9.210281098539054, 9.232883210114124, 9.263352083713162, 9.25042341676668, 9.25164860344447, 9.246873666040356, 9.27157602462423, 9.276835364778538, 9.283103797562932, 9.283436795485436, 9.275093782222248, 9.302672831657791, 9.297384021639633, 9.301503710265125, 9.30286683998164, 9.2950045004672, 9.323815711479444, 9.334172224655074, 9.330176205090773, 9.336175009837662, 9.352523333904962, 9.372050872297342, 9.371632771542094, 9.371456483735239, 9.371281084992145, 9.377309718880404, 9.390050192866054, 9.40233225666539, 9.417029425666488, 9.405265068952758, 9.409453898167696, 9.41355566320613, 9.440932383136206, 9.433492202282615, 9.451378485808862, 9.458751574619166, 9.450262439959468, 9.461567682462713, 9.470940461140335, 9.493062799433305, 9.494353408306763, 9.496029107635035, 9.504649497258244, 9.520845219293516, 9.504041790827607, 9.520641796208865, 9.556516325586172, 9.544966166872094, 9.546684628918081, 9.558366596256594, 9.562464352516605, 9.615222003969231, 9.601882241525566, 9.598172713989133, 9.62691461304801, 9.625345827756158, 9.652805112467451, 9.632004748882597, 9.642946194157608, 9.677446333842166, 9.662265692438307, 9.694054861424886, 9.693979757606563, 9.699336346043257, 9.728745960495, 9.721639375773107, 9.741110109610643, 9.73074872385212, 9.764042258378513, 9.782694631325617, 9.799591509353872, 9.811831354858786, 9.825058726080629, 9.821830973518637, 9.835772413048351, 9.833313167041018, 9.857917246831535, 9.887685990801891, 9.87181110232987, 9.916898518245093, 9.9280318773703, 9.926920444527928, 9.947216068430253, 9.975807094707335, 9.974044112541604, 9.973045119581906, 9.981048640593082, 10.021660280784449, 10.02180422099287, 10.052755748087387, 10.064046727532626, 10.087110647567492, 10.102448961816659, 10.110137108512085, 10.116346508501573, 10.147335757349682, 10.157519213766536, 10.172812726439224, 10.188287415983071, 10.202331805503214, 10.221611668655903, 10.238365896472748, 10.263102956738951, 10.265324954934028, 10.284782337215999, 10.311356832480097, 10.315040617496125, 10.331157875320569, 10.347095431353338, 10.37579575287079, 10.39680696540847, 10.396884822713778, 10.421627607026426, 10.452856222499515, 10.452351571161293, 10.474011259528346, 10.51107402476719, 10.509324893301342, 10.554442016593763, 10.565059590122504, 10.56602599078673, 10.604820723186823, 10.592627945619832, 10.638363809911102, 10.644919836095164, 10.68403925918746, 10.682991049408836, 10.701647725428336, 10.734361811164526, 10.752187670840607, 10.775075736096518, 10.787917619185645, 10.806139869604543, 10.839939577602642, 10.846727532113132, 10.856467249880616, 10.877021618683804, 10.897288270765893, 10.915172077913734, 10.964259046152282, 10.959556711545707, 10.991546149554503, 11.022013549208276, 11.02662378133612, 11.038111406422006, 11.0685113769307, 11.08086097942104, 11.100286803909844, 11.124950246984733, 11.172468057457115, 11.16330016413011, 11.175210238489264, 11.202036560962108, 11.215307493010384, 11.254355663274842, 11.286055177203934, 11.28255128650751, 11.340276782081022, 11.332478443675978, 11.346198860346192, 11.3757401489563, 11.42212754195576, 11.424580616251168, 11.448495814024712, 11.477304928565015, 11.482559212122599, 11.505608522680987, 11.522444638244533, 11.561224815715056, 11.563484049917, 11.592990492767067, 11.588671390271957, 11.631942406585868, 11.639756564381374, 11.688703419751445, 11.672037167729393, 11.705532004449196, 11.710998211095205, 11.74773787489821, 11.77770194766603, 11.785865881759666, 11.813852852377055, 11.838580026732549, 11.852387400557975, 11.867716948031866, 11.887190891673567, 11.923739057985985, 11.944728275025385, 11.97695331186649, 11.97523686066848, 12.002795873927727, 12.029716412336805, 12.027371762405117, 12.060817462994883, 12.082004811161609, 12.082156782986335, 12.105589555219689, 12.143760069894368, 12.166531747418178, 12.152123567425784, 12.185448264320875, 12.211098146208409, 12.228438487206596, 12.221469407545534, 12.269063934347482, 12.255065221133098, 12.291820936888488, 12.311446077837893, 12.329386369952365, 12.363011555651873, 12.369195302885883, 12.378711472817336, 12.402458025767366, 12.434870918607755, 12.452195300805698, 12.45713544623167, 12.466546276703319, 12.502038529984334, 12.530693472293958, 12.53622302288734, 12.537156608894625, 12.56444899067532, 12.56845356081379, 12.587529826219534, 12.612560475329849, 12.619244406773571, 12.617696049468808, 12.653596613314734, 12.648361077801848, 12.694652696048319, 12.692384584562717, 12.721718475592143, 12.721815407956083, 12.723201613454535, 12.753542314032321, 12.80268302013165, 12.790284992936783, 12.791188648757231, 12.807901369445286, 12.818506830655567, 12.838826210268051, 12.848011911866136, 12.873509402942707, 12.886553774673771, 12.90618729746425, 12.904922600048202, 12.918052946937992, 12.949615335300603, 12.957473623204743, 12.963300144015776, 12.97051536616212, 12.973607188569623, 12.988979891678982, 12.990761353996739, 13.020983722126315, 13.03048379846334, 13.038985571259483, 13.074433641543807, 13.053803676235601, 13.08420546152986, 13.076528271109526, 13.084844622259535, 13.100392164543512, 13.118395480496522, 13.115883282255817, 13.144828501437095, 13.1313969645833, 13.163920764724041, 13.157606599097095, 13.166522820034544, 13.166911897185056, 13.160485434474081, 13.192414674709486, 13.201891119627144, 13.198416436810426, 13.219615213839845, 13.235110325352197, 13.254092450369559, 13.234134864431994, 13.251606358104373, 13.264052966506963, 13.26798817117376, 13.289008401318538, 13.287097303994457, 13.277558456248498, 13.318531948852664, 13.299098131524604, 13.312754336296186, 13.315608559761863, 13.34963224745473, 13.34191713407387, 13.335150170716666, 13.361084362928464, 13.386335524204469, 13.356540537402493, 13.391359184707175, 13.383569412214952, 13.385939689069707, 13.39372506015569, 13.382322861643338, 13.405279915617255, 13.428707711294349, 13.41263484492148, 13.410244161038282, 13.43245290849667, 13.439594608016177, 13.440807813425424, 13.441395396098814, 13.454960664694566, 13.456665039319578, 13.467087939884154, 13.466977132715083, 13.46074641212721, 13.495781815194656, 13.489124579848617, 13.504096150844788, 13.470511923875156, 13.496393732181483, 13.503603460127602, 13.504126816368364, 13.531981757396697, 13.523658248717611, 13.524216826703544, 13.52140251611782, 13.529765583757113, 13.526240574090044, 13.556884666285251, 13.544491571748916, 13.544899671275722, 13.555224049596452, 13.582462677801972, 13.582258687248, 13.565762317691577, 13.569471822664482, 13.581827526626492, 13.590787630666949, 13.605646192750278, 13.602625999420146, 13.617915943448109, 13.625854391041523, 13.632309472756535, 13.632391161886032, 13.62949070873153, 13.640550958477206, 13.635402282730418, 13.641623147830169, 13.656977427982808, 13.65256854943332, 13.669459586799286, 13.660619715660388, 13.68730619562657, 13.684460533982467, 13.683808057084724, 13.707451199720813, 13.686881705824032, 13.701137289753241, 13.729101093975032, 13.723958990987782, 13.734865802045961, 13.732964528120121, 13.72904127267184, 13.737733836163649, 13.769621342775444, 13.740233302476911, 13.776229324068574, 13.791718177791278, 13.768621955591312, 13.781703335289729, 13.78775224113005, 13.802330944498259, 13.800613920535815, 13.80521356601272, 13.82599856362326, 13.849313147444553, 13.850703625326371, 13.84583587632941, 13.859008466244056, 13.873814312264367, 13.86795449970052, 13.909225725193568, 13.88578626830145, 13.910124024936728, 13.922310930812953, 13.93524030034069, 13.921443703110494, 13.940945944386932, 13.947310190485705, 13.9588842493997, 13.983524082562443, 13.977369566695348, 13.955182783349084, 13.99577305039817, 14.01276449424695, 14.025198943086234, 14.042466236769117, 14.034818923030105, 14.052567120419122, 14.06748019876453, 14.08065496259542, 14.094275911459981, 14.127138777248273, 14.11681603661656, 14.12884043724864, 14.12214497137023, 14.148855238604623, 14.158720005213306, 14.160427251031324, 14.178152694128869, 14.177612157466008, 14.212914985515456, 14.2248284143024, 14.237139905384115, 14.264448762801484, 14.266846638572108, 14.284587521786442, 14.286318016329957, 14.301188339124888, 14.329199358165242, 14.329558801839013, 14.342482474462306, 14.356747236368168, 14.37021777067164, 14.394762011310146, 14.411704933045113, 14.432177051786006, 14.44348100456816, 14.435791307238413, 14.479928987757654, 14.474229886193468, 14.486692625536229, 14.525061163106075, 14.529705580297971, 14.545381552972048, 14.58172726403813, 14.574757817093671, 14.604245760890239, 14.613894859677115, 14.652008725272042, 14.654948665893498, 14.649272495163562, 14.684934698716846, 14.704066192310519, 14.719353693471625, 14.731511199954292, 14.758763620251836, 14.755473668330433, 14.79357715961846, 14.811442887552824, 14.831290376061238, 14.845641887549439, 14.857237019706911, 14.86964612241402, 14.877165783659292, 14.924099595928842, 14.933381164892749, 14.958448768092245, 14.980910703372093, 14.988344438165372, 15.02727658746412, 15.033295329963188, 15.052266539797586, 15.069197299189423, 15.097020893242894, 15.107322509256106, 15.146085431542836, 15.141105079183795, 15.177237506168145, 15.19111852460241, 15.212704024146685, 15.218651709226199, 15.248585037869203, 15.280405862840203, 15.272603085086901, 15.291710069432364, 15.329932938456427, 15.346480311832822, 15.385764203584856, 15.396075379909453, 15.410610565957132, 15.434923324155546, 15.444593072167308, 15.472462132822647, 15.506919274045385, 15.51214602662525, 15.545710821492492, 15.564147076839225, 15.571996710715766, 15.57515848477859, 15.607554484179945, 15.651209223163429, 15.676369338381052, 15.67560406090907, 15.715379404054335, 15.725939249729281, 15.739807847033273, 15.771850101170998, 15.802963037322822, 15.814937443733443, 15.83204003573695, 15.845331191515672, 15.857676558561744, 15.894166116810217, 15.914125833313411, 15.929526690988297, 15.943618377166288, 15.966334160155597, 15.991785687378577, 16.01657568299125, 16.050695124739043, 16.067669381280133, 16.079907637334202, 16.099156775794327, 16.112872295964138, 16.13099564959433, 16.183636119234635, 16.174605658578354, 16.195015289287742, 16.21689961166079, 16.242363690564567, 16.2641795890432, 16.281357796962027, 16.29230158466747, 16.324026336355793, 16.344226954685755, 16.363907641762506, 16.38507564321758, 16.399004791024858, 16.40804794606014, 16.450630134402214, 16.477283852423906, 16.480331125213553, 16.500570044014996, 16.519027805881052, 16.528957738655603, 16.556810874289397, 16.56579289555472, 16.601405348545093, 16.603582335791728, 16.625713972044373, 16.637568502889536, 16.67070223986915, 16.693822797650597, 16.69706434174246, 16.720500625888196, 16.741131470269853, 16.755048351164838, 16.78294968148293, 16.76566860694933, 16.81536243252758, 16.832369700154295, 16.842280350108936, 16.843105353101684, 16.84964295690742, 16.877656076198924, 16.901482414500926, 16.922787533733437, 16.927589898895317, 16.955244880021542, 16.969372965147183, 16.975568386302612, 17.005346817997744, 17.020256160448028, 17.016727884192328, 17.050384508649543, 17.066888037579545, 17.066900910450666, 17.06404078395686, 17.10358504493682, 17.111272828446893, 17.14749502202581, 17.136456553798322, 17.166339370265934, 17.178642707930784, 17.17873734858546, 17.19478880231512, 17.219167691710236, 17.209776395259436, 17.230690659183104, 17.262503578708838, 17.24443546804092, 17.283282395275346, 17.28613066497393, 17.306895967803992, 17.30516345014786, 17.324832559284992, 17.335128882892118, 17.34120216380595, 17.34837299000541, 17.367378561381447, 17.391577509921408, 17.38340782817198, 17.40160789040147, 17.413231798227258, 17.421097776339245, 17.42471089891271, 17.44133714278909, 17.442011596452407, 17.500088372441102, 17.46954542008742, 17.486206935046145, 17.49281715323207, 17.51225313461636, 17.526536203220772, 17.524590213513786, 17.520397948704794, 17.53477460513451, 17.551500893346073, 17.56429532202093, 17.582697739351573, 17.578779649612795, 17.593177193956578, 17.59927940882814, 17.603687611638172, 17.61605250551387, 17.596656063078665, 17.627871746105534, 17.62890305792947, 17.644247141582223, 17.67150649654102, 17.64869553025734, 17.665448720247067, 17.673400448529847, 17.679121764982195, 17.698271419490037, 17.68135649026115, 17.720266766795646, 17.700698269944915, 17.717233555823693, 17.720539289232985, 17.7266315473001, 17.740814896544443, 17.74847627353292, 17.766004540876114, 17.768586836226383, 17.74933711635721, 17.75638505481491, 17.765329460594714, 17.777085992131493, 17.78531007576179, 17.790776031549303, 17.801201582568325, 17.793180179828614, 17.798568819758813, 17.787656234882597, 17.817880882550458, 17.809205023572527, 17.823112155299942, 17.845087508093886, 17.846981710753454, 17.83563446000297, 17.845260935733858, 17.86645358913549, 17.865098141741704, 17.85657060376512, 17.86107669876227, 17.878328003590468, 17.878930876866807, 17.888405721619044, 17.889752934873066, 17.887078386278567, 17.897014513878368, 17.88950865682629, 17.924206505689167, 17.927772272983155, 17.92726491377148, 17.925847100566774, 17.921384176393225, 17.927711710173845, 17.94508488820267, 17.954256418006366, 17.96278784024496, 17.961673862909016, 17.964288334740516, 17.952763461583945, 17.98646417023142, 17.972677373249148, 17.995526714152707, 18.00666785082774, 18.003917336444033, 17.999740003433036, 18.012865358296068, 18.014113163431478, 18.013082867622636, 18.026885083340446, 18.06008471594842, 18.02875665263822, 18.031304280216794, 18.0552941129673, 18.05367135822069, 18.073972708485883, 18.055294531878864, 18.079410403630213, 18.076804081345553, 18.0854595009851, 18.103841133727506, 18.12002057722323, 18.116243783077028, 18.12218388258355, 18.117613990810863, 18.131302634382372, 18.136191513445187, 18.149060925636157, 18.16600702290535, 18.16013539016359, 18.170168186438666, 18.164745459729087, 18.18626501151021, 18.191887373686527, 18.21578051354064, 18.21810616303205, 18.21997885047572, 18.20457301536498, 18.23375310595577, 18.239525553767557, 18.258873410081854, 18.256399579282064, 18.268687284187354, 18.280300569006734, 18.283471692635963, 18.30673134724777, 18.329482960690903, 18.31789031041189, 18.327753527285715, 18.324790178959898, 18.36182156317015, 18.35418989938512, 18.368925233350573, 18.382877234618142, 18.393247896691076, 18.40371572601301, 18.4159086169964, 18.420682550984125, 18.43014135765893, 18.456564117405335, 18.454991768692476, 18.474113968090656, 18.481890181962346, 18.49741116673515, 18.523281211782898, 18.530263076299985, 18.527764512570123, 18.544550835001097, 18.56091353969913, 18.580783164608196, 18.58057154786988, 18.585519174312562, 18.59965147264745, 18.622781253716774, 18.643524394394667, 18.64962161250528, 18.673369051478257, 18.674850940549344, 18.700254556970798, 18.70217223178392, 18.733097789571445, 18.72571469099092, 18.73576039009902, 18.76280616520135, 18.788080909264817, 18.786479046125727, 18.814921473785024, 18.83188036877804, 18.83108824490528, 18.854343964846983, 18.878479368743157, 18.90899424585449, 18.90578005254041, 18.919496883843138, 18.948783372279173, 18.96902217824871, 18.97488996820789, 18.994764267644996, 19.012210958617388, 19.045105713651285, 19.028309571426295, 19.065391915412533, 19.071904625101, 19.11325780219155, 19.11707999243284, 19.1224751462437, 19.149937811342536, 19.184928376571477, 19.18427506888451, 19.195867542173797, 19.212907905002787, 19.250599102735183, 19.244213152651596, 19.280032797561013, 19.30047759269973, 19.298019177342532, 19.31916511131447, 19.35247887909755, 19.374014810106406, 19.389589282126693, 19.416781589964067, 19.425909256540393, 19.451082319374024, 19.47487886664242, 19.494292762418166, 19.518606825239342, 19.541456241624214, 19.56165935285189, 19.58965229470042, 19.598240335919805, 19.62650016676015, 19.642355312516862, 19.672986261476748, 19.66808873701427, 19.689134824889024, 19.7041253806252, 19.735303781582004, 19.77443371686775, 19.744951613891054, 19.789340640715263, 19.805951004243358, 19.832734946250234, 19.845410946933967, 19.878982633480994, 19.87931419678649, 19.927967242055857, 19.930185464375842, 19.947411037639327, 19.99300895909917, 20.01205715606114, 20.015457208747243, 20.046483427946015, 20.083769543667557, 20.068323684113988, 20.103611742113223, 20.12317974841855, 20.127533960845813, 20.172707311084952, 20.176835075728402, 20.22245915999702, 20.21762711224627, 20.26157894290731, 20.284836963121386, 20.291839155933488, 20.303288146566434, 20.32704354148928, 20.353268268220784, 20.393733282735305, 20.418223354742256, 20.42357556159696, 20.442813885428585, 20.4526388370832, 20.47888218165017, 20.503181824632367, 20.529147617840003, 20.544812631131222, 20.55990589281398, 20.57048804512571, 20.604654355129835, 20.626860054605967, 20.64338151372705, 20.67768105388728, 20.681836818177654, 20.7011753240105, 20.717543241230903, 20.724220704058684, 20.753480196726382, 20.775047817535956, 20.798055023244668, 20.8130383232197, 20.830863533642706, 20.84520920430995, 20.856085571273297, 20.884590324898735, 20.933339270055072, 20.927217038951873, 20.946960110255723, 20.957971499365684, 20.989717685208742, 21.01008043070719, 21.03310377895717, 21.034539103168115, 21.051886976458775, 21.07374996295066, 21.098989943241932, 21.10352194932289, 21.145285232106446, 21.139647914128993, 21.161186589219927, 21.18017443240194, 21.191275782647544, 21.23238922603534, 21.210507780363365, 21.239451768322898, 21.260039688235917, 21.28246343295878, 21.3007336245638, 21.305058140646103, 21.3126204535831, 21.359930980243085, 21.35571285643786, 21.371311861910133, 21.391392975498057, 21.42113555717409, 21.421534909826338, 21.438985721558026, 21.447853089666115, 21.471923664821976, 21.482900995684886, 21.486049519976618, 21.51482548675648, 21.513579357461182, 21.542955092684792, 21.54744050440547, 21.538911712843355, 21.562463172292542, 21.5712882631838, 21.60392509763695, 21.60600668357125, 21.61706622666878, 21.646141700225126, 21.66033614610251, 21.648266142792412, 21.659146746884577, 21.696789254247516, 21.702069556679778, 21.714268990947364, 21.704216380530493, 21.722444809688653, 21.73833458427179, 21.768988949464497, 21.759981850752173, 21.777554183912716, 21.802782755869785, 21.801074687950845, 21.807504755153843, 21.79970114203655, 21.82958780864506, 21.839065033722196, 21.853308295426235, 21.86236533979424, 21.887064074093043, 21.86344731179081, 21.89550740625833, 21.886926734739262, 21.899259393264284, 21.90408489058138, 21.920096863444105, 21.92941642662319, 21.94789189272882, 21.94375081421155, 21.95591309885476, 21.957482329326403, 21.979414691756613, 21.986987752520204, 21.963683773150674, 22.000812180597972, 21.99141599146986, 21.991455507727135, 21.992977509290203, 22.018759972877554, 22.016453200223687, 22.028320552579597, 22.04848749296221, 22.049529729671452, 22.062937699189273, 22.069692600034998, 22.085690087590642, 22.07580361344181, 22.06208911685489, 22.077328928892154, 22.09559690564867, 22.095632248881962, 22.10789510366258, 22.119680255535336, 22.119328849831394, 22.122991732713164, 22.126230163487783, 22.111848156248364, 22.14107805129667, 22.15993239680992, 22.164653695983983, 22.157610075613054, 22.16440803857966, 22.17729858933922, 22.173261090976727, 22.17067804932299, 22.19408720515677, 22.187831069701577, 22.207203504412266, 22.211173990851567, 22.210941783749742, 22.217592969506658, 22.222647436086966, 22.2253143225975, 22.237065277797498, 22.228478928322822, 22.237473421976322, 22.251191662905565, 22.27468113527987, 22.259895988772076, 22.269314325972974, 22.29508518247859, 22.268366015312125, 22.27041692883456, 22.273916973713284, 22.27579694562622, 22.315586880682527, 22.29105441713353, 22.30491163139577, 22.308263273931633, 22.346264698209783, 22.309139404456896, 22.32552009458644, 22.327525310689897, 22.329714256185653, 22.327319096341625, 22.345600052535094, 22.363802733770438, 22.350599057081894, 22.35989254644152, 22.378047823428716, 22.38415768458236, 22.38407875961691, 22.385580035358792, 22.40340549983656, 22.423570993388903, 22.412420167295366, 22.404815151054766, 22.4212523167437, 22.404609083861928, 22.441106205327493, 22.447408548688657, 22.449050009391218, 22.458930258899187, 22.46205443580069, 22.448755335371224, 22.47282571513596, 22.482253536936916, 22.482183769177905, 22.502174545819766, 22.511448089100615, 22.514992599409794, 22.516982719967423, 22.543444783685754, 22.548313241497855, 22.53331848341793, 22.540065139060182, 22.550429159278263, 22.569068702339692, 22.55922526321925, 22.585673874869347, 22.593949819279842, 22.573500013812946, 22.619511397736098, 22.62711482692323, 22.614787390813007, 22.62521109803331, 22.651177826899794, 22.64162077835371, 22.663312856470046, 22.682641598147075, 22.68613241891367, 22.701643614015218, 22.694586223210163, 22.7108179269535, 22.729591269482665, 22.730332276626008, 22.765649501565314, 22.772675842421197, 22.772272351502238, 22.782350898767746, 22.802878205854256, 22.783013339029726, 22.807345267951117, 22.845050932354177, 22.84173803259725, 22.842342389253897, 22.84772763840675, 22.9087000751952, 22.8880741539139, 22.901949923949733, 22.91958413248719, 22.934574107906556, 22.945831934599944, 22.96042650949305, 22.975859621200375, 22.987101522458946, 23.000650884937127, 23.01336412831895, 23.005364711423844, 23.05225629998982, 23.053576610555695, 23.070001427341513, 23.077344918893086, 23.107552526153377, 23.114291838940485, 23.114407003510316, 23.15040128218728, 23.17912487850023, 23.15850388162083, 23.196925757526397, 23.1965865817932, 23.22565839227632, 23.230129597003497, 23.243337259035783, 23.265133331572958, 23.284478420218143, 23.301369664268996, 23.31698523566489, 23.325935532472347, 23.371803955555226, 23.360632859164497, 23.393198730714897, 23.41581450196385, 23.439635294658913, 23.436383547310854, 23.464614705329293, 23.488340598162143, 23.50068077115789, 23.517376310085602, 23.544625066947326, 23.548919306147962, 23.5598503892718, 23.575828376370787, 23.592996566976428, 23.619451963133734, 23.62411984603512, 23.65339710552884, 23.682443155004602, 23.697654217394035, 23.726642369662386, 23.738568917046365, 23.746908324706702, 23.77201535691781, 23.78883197867101, 23.810334928953235, 23.826749132297014, 23.86231100330619, 23.864502700618107, 23.889495517590497, 23.91016741482823, 23.927627796971628, 23.95433789862717, 23.971491197697706, 24.01269291290799, 24.01982304778833, 24.02157547905904, 24.05258398057356, 24.08235903332398, 24.09215869213773, 24.10508102685544, 24.156130307100756, 24.149135570034296, 24.164950593385147, 24.190455163668222, 24.223460252194517, 24.23837858125461, 24.24106229646581, 24.29920266066982, 24.317714295969864, 24.33081581092454, 24.34892349034071, 24.363578115777223, 24.397063673701666, 24.42737045364834, 24.43683998084891, 24.444748666721246, 24.46700832053336, 24.48845797679257, 24.508937307732698, 24.53292451161649, 24.5482592539044, 24.565297757983537, 24.59444982216122, 24.609426581773928, 24.64415407432625, 24.660568618340278, 24.659885860986616, 24.702042396388112, 24.71975322696413, 24.75031460397685, 24.76169430633012, 24.78819689119986, 24.812150700744255, 24.829797943792364, 24.852263172998004, 24.868729792765464, 24.88652279657775, 24.894082488957537, 24.909442647850643, 24.954652915082047, 24.96423010060155, 24.976519957337327, 25.00711038334158, 25.0239844880824, 25.04056777375285, 25.07133677784847, 25.0785820649649, 25.118281875553112, 25.113383816868186, 25.147375808969723, 25.150203730372297, 25.170232870474987, 25.21150941806299, 25.22675587621927, 25.228108049397342, 25.254579701230472, 25.255215841384555, 25.28246225610785, 25.30651780393814, 25.332271405182055, 25.340348471526305, 25.37137503520055, 25.382412343355046, 25.415475671508425, 25.417526701260723, 25.44443897405488, 25.45247571831428, 25.471986279716916, 25.467451399922663, 25.501880226738503, 25.52320650453578, 25.51818023398332, 25.54565951877567, 25.565707491866753, 25.591569142247124, 25.60349735247777, 25.61786503775098, 25.631285600483455, 25.64746215477648, 25.664243912465224, 25.666105803141566, 25.692869170107148, 25.72309172499763, 25.72141127178514, 25.75062157958588, 25.746197062618204, 25.787309134336663, 25.779870520250952, 25.81146315112303, 25.817405970432628, 25.835113367762645, 25.843155253233633, 25.88029859777355, 25.883689112652537, 25.896475443215614, 25.884017900144073, 25.901531610509608, 25.924345863730206, 25.940577115830024, 25.961250017900788, 25.966591816797333, 26.000117449576315, 25.98887379459366, 26.01400842501385, 26.013647526157992, 26.025831292023526, 26.028187707269186, 26.05629866335557, 26.080644459778803, 26.06831550376623, 26.074943752247925, 26.105768244770573, 26.132045228286298, 26.11077236015067, 26.156257539118144, 26.137132073348095, 26.149877376942104, 26.157186184692097, 26.174762307121483, 26.194198051506316, 26.19164343166855, 26.20821058260848, 26.206884950669732, 26.21615787813037, 26.22598570811851, 26.242959286253043, 26.234901581402127, 26.27041164225449, 26.263781591951904, 26.27931743404939, 26.27583646376247, 26.291772197403354, 26.30565633379493, 26.30458379434358, 26.31720603035161, 26.320738360479492, 26.34526112762032, 26.34603839520642, 26.356500214705637, 26.35998821464918, 26.358271209818614, 26.362716185086, 26.3948837543547, 26.393971317438787, 26.40577951818464, 26.400142464955596, 26.403567181948876, 26.40226797072398, 26.432425867120276, 26.40150440425463, 26.43372567786966, 26.435544438612244, 26.445701000507476, 26.44161067695048, 26.458746391141347, 26.45804016953067, 26.46422749857258, 26.477817554145343, 26.489179466263085, 26.498491045566578, 26.509926197690163, 26.50133119064206, 26.499481300723556, 26.501632115036546, 26.500833791292614, 26.529554582898108, 26.52671909876518, 26.536802363772264, 26.539508709284554, 26.5331530951679, 26.547590955523642, 26.546393389262917, 26.56050699959926, 26.57197941935788]
data_size = len(theta)
theta = np.array(theta)
#x = np.arange(data_size)
tlist = [i*0.01 for i in range(data_size)]
print("总时长：",len(tlist)*0.01,"s")
print("数据量:",data_size)


# In[69]:


a = 0.785
omega = 1.884
b = 1.305
beta = 1/0.01
alpha = 0.5
alpha_E = np.diag([alpha,alpha,alpha])#共轭高斯先验的协方差矩阵的逆矩阵
mu_0 = np.array([0,0,0]).reshape((-1,1)) #共轭高斯先验的均值
nums = [1,10,20,40,60,75,85,100] #数据量对贝叶斯线性回归的影响,画出2*3个子图
plot_num = 10 #画多少条曲线


# In[66]:


# 画出图像
fig = plt.figure(num = 1,figsize=(10,10),dpi = 80)
ax = fig.add_subplot(1,1,1)
ax.scatter(tlist[:1000:10],theta[:1000:10])
ax.grid()
plt.show()


# In[67]:


t = np.array(tlist[:1000:10]).copy().reshape(-1,1)
y = theta[:1000:10].copy().reshape(-1,1)
y = y- b*t
def func(x,a,omega):
    # x是时间
    func1 = -a/omega*np.cos(omega*x)
    func2 = a/omega*np.sin(omega*x)
    func3 = np.ones(t.shape[0]).reshape((-1,1))
    return np.hstack((func1,func2,func3)).copy()
# fig = plt.figure(num = 1,figsize=(10,10),dpi = 80)
# ax = fig.add_subplot(1,1,1)
# ax.scatter(t,y)
# ax.grid()
# plt.show()
w = [0,0,0] # 待估计系数：y = w[0]*(-a/omega)cosomegat+w[1]*a/omega*sinomegat+w[2] 
x_ = func(t,a,omega)


# In[73]:


print(ww.shape)
print(test_x_phi.shape)
print(test_x.shape)


# In[75]:


fig,axes = plt.subplots(4,2,figsize=(20,30),dpi=80)
axes = axes.flatten()

for num ,ax in zip(nums,axes):
    # 得到参数w的后验高斯分布
    S = np.linalg.inv(alpha_E+beta*np.dot(x_[:num].T,x_[:num]))
    mu = beta*np.dot(np.dot(S,x_[:num].T),y[:num])+np.dot(np.dot(S,alpha_E),mu_0)
    
    #画出w后验高斯分布下的图像
    ww = np.random.multivariate_normal(mean=mu.flatten(),cov=S,size = plot_num)#维度为size*mean_shape
    x_max,x_min = int(np.max(t))+1,int(np.min(t))-1
    
    test_x = np.linspace(x_min,x_max,100).reshape((-1,1))
    test_x_phi = func(test_x,a,omega)
    test_y = np.dot(ww,test_x_phi.T)+b*test_x.T # 随机曲线
    test_y_std = np.sqrt(1/beta+np.dot(np.dot(test_x_phi,S),test_x_phi.T).diagonal())
    
    for i in range(plot_num):
        ax.plot(test_x,test_y[i],'gray')
    y_hat = np.dot(test_x_phi,mu)+b*test_x#预测曲线
    ax.plot(test_x,y_hat,'r')
    
    ax.fill_between(test_x.flatten(),(y_hat-test_y_std[:,np.newaxis]).flatten()
                    ,(y_hat+test_y_std[:,np.newaxis]).flatten(),color = 'lightgray')
    ax.scatter(t[:num],y[:num]+b*t[:num],marker='o')
    ax.set_xlim(x_min,x_max)
    ax.set_xlabel('x')
    ax.set_ylabel('y')
#     test_w.append(tuple(mu.flatten()))
#     rand_ww = np.random.multivariate_normal(mean=mu.flatten(),cov=S,size = rand_num)
#     rand_w.append(rand_ww)


# In[93]:


print(mu[0,0])
print(mu[1,0])
print(math.acos(mu[0,0]))
print(math.asin(mu[1,0]))
print(math.atan(mu[1,0]/mu[0,0])-math.pi+2*math.pi)

